# ä»£ç ä¿®æ”¹æŒ‡å—

## ğŸ“‹ éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

åªéœ€ä¿®æ”¹**1ä¸ªæ–‡ä»¶**ï¼š`knowledge/rag_manager.py`

---

## ğŸ“ å…·ä½“ä¿®æ”¹æ­¥éª¤

### ä¿®æ”¹1ï¼šåœ¨__init__æ–¹æ³•æœ«å°¾æ·»åŠ ä¸€è¡Œ

**æ–‡ä»¶ä½ç½®**ï¼š`knowledge/rag_manager.py`

**åŸå§‹ä»£ç **ï¼š

```python
class RAGManager:
    def __init__(self, config):
        self.config = config
        self.psych_kb = ChromaKnowledgeBase("psychology")
        self.user_kb = ChromaKnowledgeBase("user_info")
        # åŸæœ‰ä»£ç åˆ°è¿™é‡Œç»“æŸ
```

**ä¿®æ”¹å**ï¼š

```python
class RAGManager:
    def __init__(self, config):
        self.config = config
        self.psych_kb = ChromaKnowledgeBase("psychology")
        self.user_kb = ChromaKnowledgeBase("user_info")
        
        # â† æ·»åŠ è¿™ä¸€è¡Œ
        self._auto_load_mentalchat()
```

---

### ä¿®æ”¹2ï¼šåœ¨ç±»æœ«å°¾æ·»åŠ åŠ è½½æ–¹æ³•

**åœ¨ `RAGManager` ç±»çš„æœ«å°¾**æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š

```python
def _auto_load_mentalchat(self):
    """è‡ªåŠ¨åŠ è½½MentalChat16KçŸ¥è¯†åº“ï¼ˆå¦‚æœå­˜åœ¨ï¼‰"""
    import os
    from knowledge.data_loaders import DataLoader
    
    csv_path = 'data/datasets/MentalChat16K_train.csv'
    
    # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if not os.path.exists(csv_path):
        print("â„¹ï¸  MentalChat16Kæ•°æ®é›†æœªæ‰¾åˆ°ï¼Œè·³è¿‡åŠ è½½")
        return
    
    print("\n" + "="*60)
    print("è‡ªåŠ¨åŠ è½½MentalChat16KçŸ¥è¯†åº“")
    print("="*60)
    
    try:
        # åˆ›å»ºæ•°æ®åŠ è½½å™¨
        loader = DataLoader(
            chunk_size=600,      # å‚è€ƒMentalic Net
            chunk_overlap=0,
            min_length=50
        )
        
        # åŠ è½½æ•°æ®
        print("æ­£åœ¨åŠ è½½MentalChat16Kæ•°æ®é›†...")
        documents = loader.load_csv(
            csv_path,
            question_col='question',
            answer_col='answer'
        )
        
        print(f"âœ… æˆåŠŸåŠ è½½ {len(documents)} ä¸ªæ–‡æ¡£")
        
        # æ·»åŠ åˆ°å¿ƒç†å­¦çŸ¥è¯†åº“
        print("æ·»åŠ åˆ°å‘é‡æ•°æ®åº“...")
        for i, doc in enumerate(documents):
            self.psych_kb.add_document(
                content=doc.content,
                metadata=doc.metadata
            )
            
            # æ˜¾ç¤ºè¿›åº¦
            if (i + 1) % 1000 == 0:
                print(f"  è¿›åº¦: {i+1}/{len(documents)}")
        
        print(f"âœ… å®Œæˆï¼MentalChat16KçŸ¥è¯†åº“å·²åŠ è½½")
        print("="*60 + "\n")
        
    except Exception as e:
        print(f"âš ï¸  åŠ è½½MentalChat16Kæ—¶å‡ºé”™: {str(e)}")
        print("   ç³»ç»Ÿå°†ä½¿ç”¨åŸæœ‰çŸ¥è¯†åº“ç»§ç»­è¿è¡Œ")
```

---

## âœ… ä¿®æ”¹å®Œæˆæ£€æŸ¥

ä¿®æ”¹å®Œæˆåï¼Œæ£€æŸ¥ï¼š

- [ ] `__init__` æ–¹æ³•æœ«å°¾æœ‰ `self._auto_load_mentalchat()`
- [ ] ç±»æœ«å°¾æœ‰ `_auto_load_mentalchat` æ–¹æ³•
- [ ] ä¿å­˜äº†æ–‡ä»¶

---

## ğŸ§ª æµ‹è¯•ä¿®æ”¹

```bash
# æµ‹è¯•ç³»ç»Ÿèƒ½å¦æ­£å¸¸å¯åŠ¨
python examples/basic_rag_chat.py

# è¿è¡Œé›†æˆæµ‹è¯•
python test_integration.py
```

---

## ğŸ“Š ä¿®æ”¹å‰åå¯¹æ¯”

### ä¿®æ”¹å‰

```python
class RAGManager:
    def __init__(self, config):
        self.config = config
        self.psych_kb = ChromaKnowledgeBase("psychology")
        # æ²¡æœ‰è‡ªåŠ¨åŠ è½½MentalChat16K
```

### ä¿®æ”¹å

```python
class RAGManager:
    def __init__(self, config):
        self.config = config
        self.psych_kb = ChromaKnowledgeBase("psychology")
        
        # è‡ªåŠ¨åŠ è½½MentalChat16K
        self._auto_load_mentalchat()
    
    # ... å…¶ä»–æ–¹æ³• ...
    
    def _auto_load_mentalchat(self):
        # åŠ è½½é€»è¾‘
        pass
```

---

## âš ï¸ é‡è¦æç¤º

### å‘åå…¼å®¹æ€§

- âœ… åŸæœ‰åŠŸèƒ½å®Œå…¨ä¿ç•™
- âœ… å¦‚æœæ•°æ®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨è·³è¿‡
- âœ… ä¸ä¼šç ´åç°æœ‰ç³»ç»Ÿ

### ä¸è¦ä¿®æ”¹çš„æ–‡ä»¶

- âŒ `memory/` ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶
- âŒ `dialogue/` ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶
- âŒ `evaluation/` ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶

---

## ğŸ‰ å®Œæˆï¼

ä¿®æ”¹å®Œæˆåï¼š

1. âœ… ç³»ç»Ÿæ¯æ¬¡å¯åŠ¨è‡ªåŠ¨åŠ è½½MentalChat16K
2. âœ… çŸ¥è¯†åº“è‡ªåŠ¨æ‰©å¤§åˆ°68,228ä¸ªæ–‡æ¡£
3. âœ… RAGæ•ˆæœè‡ªåŠ¨æå‡

---

éœ€è¦å¸®åŠ©ï¼ŸæŸ¥çœ‹ `é›†æˆæŒ‡å—.md` æˆ–è¿è¡Œ `python test_integration.py`
